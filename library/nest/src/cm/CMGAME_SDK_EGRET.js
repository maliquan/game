/**
 * CMCM Game SDK - CMGAME_SDK_EGRET.js
 * version: 2.0.2
 * Build: Tue Feb 16 2016 14:55:02 GMT+0800 (中国标准时间)
 * link: http://game.liebao.cn/game/cm_game_sdk/doc/
 */
if (nest.utils.$isRuntime) {
    if (egret_native.getOption("egret.runtime.spid") == 10044
        || (!egret_native.getOption("egret.runtime.nest"))) {
        !function t(e,n,r){function a(i,c){if(!n[i]){if(!e[i]){var s="function"==typeof require&&require;if(!c&&s)return s(i,!0);if(o)return o(i,!0);var u=new Error("Cannot find module '"+i+"'");throw u.code="MODULE_NOT_FOUND",u}var f=n[i]={exports:{}};e[i][0].call(f.exports,function(t){var n=e[i][1][t];return a(n?n:t)},f,f.exports,t,e,n,r)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<r.length;i++)a(r[i]);return a}({1:[function(t,e,n){var r=function(){return this}(),a=r.CMGAME_SDK_EGRET={},o=t(9),i=t(8),c=t(5),s=!1;o.getVersion=function(){return s},i.checkIsGameSDK(function(t,e){t&&(s=e)}),a.pay=r.CMPAY_EGRET=o,a.client=r.CMGAME_EGRET=i,a.ad=c},{5:5,8:8,9:9}],2:[function(t,e,n){function r(t){var e,n=!1,r=!1,o=[];return function(i){n?i.apply(null,e):(o.push(i),r||(r=!0,t(function(){n||(n=!0,r=!1,e=a.slice(arguments),a.forEach(o,function(t){t.apply(null,e)}),o.length=0,o=null)})))}}var a=t(12);e.exports=r},{12:12}],3:[function(t,e,n){e.exports=function(t){var e,n=!1,r=!1,a=[];return function(o){n?o(n,e):(a.push(o),r||(r=!0,t(function(t,o){n=t,n&&(e=o),setTimeout(function(){r=!1;for(var t=0,o=a.length;o>t;++t){var i=a[t];i(n,e)}a.length=0,n&&(a=null)})})))}}},{}],4:[function(t,e,n){function r(){this._listeners={}}var a=t(12),o=r.prototype;o.on=function(t,e){var n,r=this._listeners;n=r.hasOwnProperty(t)?r[t]:r[t]=[],n.push(e)},o.off=function(t,e){var n,r=this._listeners;r.hasOwnProperty(t)&&(n=r[t]);for(var a=n.length,o=0;a>o;++o)n[o]===e&&n.splice(o,1)},o.fire=function(t){var e=this._listeners;if(e.hasOwnProperty(t))for(var n=a.slice(arguments,1),r=e[t],o=r.length,i=r.slice(),c=0;o>c;++c){var s=i[c];try{s.apply(null,n)}catch(u){}}},e.exports=r},{12:12}],5:[function(t,e,n){function r(t){this._option=t}function a(t,e){function n(){if(a>r){var o=t[r],i=o.type;if(i&&l.hasOwnProperty(i)){var c=l[i];c.canShow?c.canShow(function(t){t?e(o):(++r,n())}):e(o)}else++r,n()}else e(null)}var r=0,a=t.length;n()}function o(t){var e=Date.now();return 3e4>e-g?h.error("Only one ad allowed in 30s"):(g=e,t=f({gameid:"",pos:r.POS_CENTER},t),i||(i=d(function(e){s.ajax({url:"http://api.gc.liebao.cn/index.php?r=1/cp",data:{gameid:t.gameid}},function(t,n,r){var a;if(t)try{a=JSON.parse(r)}catch(o){}e(Boolean(t&&a&&0===a.ret&&a.data),a)})})),void i(function(e,n){if(e){var o=n.data,i=t.pos||r.POS_CENTER;c&&(c.destroy(),c=null);var s=o[i];if(!s||!s.length)return;a(s,function(e){if(e){var n=e.type,r=f({gameid:t.gameid,debug:t.debug,adtype:n,pos:i,container:document.documentElement},e),a=l[n],o=new a(r);c=o,o.show()}})}}))}var i,c,s=t(11),u=t(12),f=u.extend,d=t(3),l={gdt:t(7)};r.POS_CENTER=1,r.POS_BOTTOM=2,r.show=o;var p=r.prototype;p.show=function(){o(this._option)};var h=function(){return this.console}(),g=0;e.exports=r},{11:11,12:12,3:3,7:7}],6:[function(t,e,n){function r(){}var a=t(11).report,o={show:1,click:2,close:3,error:4},i=r.prototype;i._report=function(t,e){var n=this._option;a("http://api.gc.liebao.cn/index.php?r=1/cp/report",{gameid:n.gameid,type:t,clientId:n.clientId,slotId:n.slotId,_code:e,adtype:n.adtype,_:Math.random()})},i._onShow=function(){this._report(o.show)},i._onError=function(t){this._report(o.error,t)},i._onClick=function(){this._report(o.click)},i._onClose=function(t){this._report(o.close,t)},e.exports=r},{11:11}],7:[function(t,e,n){function r(t){var e=this;e._option=t,e._destroyed=!1}var a=t(8),o=t(12),i=t(6);r.canShow=function(t){a.checkIsGameSDK(t)};var c=r.prototype=o.create(i.prototype);c.show=function(){var t=this,e=t._option;return!t._destroyed&&e&&e.clientId&&e.slotId?(a.callWidePointAd({clientid:e.clientId,posid:e.slotId}),void t._onShow()):t._onError(-902)},c.destroy=function(){var t=this;t._destroyed=!0},e.exports=r},{12:12,6:6,8:8}],8:[function(t,e,n){function r(t,e){var n=!1,r=!1,a=egret.setTimeout(function(){r||(r=!0,e(n))},null,t);egret.ExternalInterface.addCallback("get_game_sdk_version",function(t){egret.clearTimeout(a),r||(r=!0,n=t,e(n))}),egret.ExternalInterface.call("get_game_sdk_version","")}function a(t){egret.ExternalInterface.addCallback("get_device_info",function(e){var n=!1;if("string"==typeof e)try{n=JSON.parse(e)}catch(r){}else n=e;c=n,t(n)})}var o=t(2),i=n;i.checkIsGameSDK=o(function(t){r(1e4,function(e){e&&!isNaN(e)?t(!0,e):t(!1,-1)})}),i.saveShortcutInfo=function(t){egret.ExternalInterface.call("save_shortcut_info",JSON.stringify({token:String(Math.random()),value:JSON.stringify(t)}))},i.pushIcon=function(t){t.title=t.Title,t.detailUrl=t.DetailUrl,t.picUrl=t.PicUrl,egret.ExternalInterface.call("push_icon",JSON.stringify(t))},i.dispatchGameLoginData=function(){var t;return egret.ExternalInterface.addCallback("dispatchGameLoginData",function(e){if(t){var n=!1;if("string"==typeof e)try{n=JSON.parse(e)}catch(r){}else n=e;t(n)}}),function(e,n){var r=t;t=function(e){t=r,n(e)},egret.ExternalInterface.call("dispatchGameLoginData",JSON.stringify(e))}}();var c="";i.getGameSDKDeviceID=function(){return c},i.getGameSDKDeviceIDAsync=o(a),i.wsjLaunchPay=function(){var t={};return egret.ExternalInterface.addCallback("wsj_pay",function(e){var n;try{n=JSON.parse(e)}catch(r){}var a;if(n&&(a=n.token),a&&t.hasOwnProperty(a)){var o;try{o=JSON.parse(n.response)}catch(r){}var i=t[a];delete t[a],i(o)}}),function(e,n){var r=String(Math.random());t[r]=n,egret.ExternalInterface.call("wsj_pay",JSON.stringify({token:r,request:JSON.stringify(e)}))}}()},{2:2}],9:[function(t,e,n){function r(t){o.place({data:t,debug:"undefined"!=typeof t.debug?t.debug:Boolean(window.CMPAY_DEBUG)},function(t,e,n,r){c.fire("cmpay_order_placed",{type:"cmpay_order_placed",transaction_id:r&&r.data?r.data.transaction_id:null,ret:e,msg:n,success:t,response:r}),t?i(r.data.args,function(t){var e=t&&"number"==typeof t.resultCode?t.resultCode:-99,n=t&&0===t.resultCode;c.fire("cmpay_order_complete",{type:"cmpay_order_complete",transaction_id:r.data.transaction_id,ret:e,success:n,payed:n,paid:n,wsjResponse:t})}):c.fire("cmpay_order_complete",{type:"cmpay_order_complete",transaction_id:r&&r.data?r.data.transaction_id:null,ret:-99,success:!1,payed:!1,paid:!1,wsjResponse:null})})}var a=t(4),o=t(10),i=t(8).wsjLaunchPay,c=e.exports=new a;c.purchase=r},{10:10,4:4,8:8}],10:[function(t,e,n){function r(t,e){a({pay_method:"wsjpay/sdk",data:t.data,debug:t.debug},function(t,n,r){var a,o="Unkown error";if(r){r=r.replace(/"transaction_id":(\d+)/,'"transaction_id":"$1"');try{a=JSON.parse(r)}catch(i){t=!1,o="Empty response"}}else t=!1;var c=t&&a&&a.data&&a.data.args&&a.data.args.goodsTokenUrl&&1===a.ret;if(c&&a.data){var s=a.data.goodsTokenUrl;o=s?"ok":"Empty goods token url"}e(c,c?0:a?a.ret:-1,o,a)})}function a(t,e){var n=t.data&&t.data.access_token;n?s(function(r){if(32===n.length||"sdk"===n.slice(0,3)){var a={token:n,method:t.pay_method,dev:t.debug?1:null,packageInfo:r},c=t.data;for(var s in c)c.hasOwnProperty(s)&&"access_token"!==s&&(a[s]=c[s]);o({method:"GET",url:"http://gclogin.liebao.cn/api/native/order/pay",data:a},e)}else{var c=t.data;c.packageInfo=r,o({method:"GET",url:"http://gc.liebao.cn/pay/topay.php",data:{method:t.pay_method,args:i(c),dev:t.debug?1:null}},e)}}):e(!1,-1,'{"msg":"Token not provided."}')}var o=t(11).ajax,i=t(12).param,c=t(2),s=c(function(t){var e=egret.setTimeout(function(){t("")},null,1e3);egret.ExternalInterface.addCallback("getPackageInfo",function(n){egret.clearTimeout(e),t(n)}),egret.ExternalInterface.call("getPackageInfo","")});n.place=r},{11:11,12:12,2:2}],11:[function(t,e,n){function r(t,e){var n=new egret.URLLoader,r=new egret.URLRequest;t.method&&"post"===t.method.toLowerCase()&&(r.method=egret.URLRequestMethod.POST);var a="";t.data&&(a="string"==typeof t.data?t.data:o(t.data),r.data=new egret.URLVariables(a)),r.url=t.url,n.dataFormat=egret.URLLoaderDataFormat.TEXT,n.addEventListener(egret.Event.COMPLETE,function(){e(!0,0,n.data)}),n.addEventListener(egret.IOErrorEvent.IO_ERROR,function(){e(!1,-1,n.data)},this),n.load(r)}function a(){}var o=t(12).param;n.ajax=r,n.report=a},{12:12}],12:[function(t,e,n){function r(t){var e=[];for(var n in t)if(t.hasOwnProperty(n)){var r=t[n],a=typeof r;("number"===a||"string"===a||"boolean"===a)&&e.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}return e.join("&")}function a(t,e){var n;if(t&&"object"==typeof t){var r=t.length;if("number"==typeof r){if(0===r)return;if(0 in t&&[r-1]in t){for(n=0;r>n&&e(t[n],n)!==!1;++n);return}}for(n in t)if(t.hasOwnProperty(n)&&e(t[n],n)===!1)break}}function o(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function i(){}function c(t){return i.prototype=t,new i}var s=Array.prototype.slice,u=function(t,e,n){return s.call(t,e,n)};n.param=r,n.forEach=a,n.slice=u,n.extend=o,n.create=c},{}]},{},[1]);
    }
}
